<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
  <title>Aniversariantes IEQ Bela Vista</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    h2 {
      text-align: center;
      margin-bottom: 30px;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px 12px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
      cursor: pointer;
      user-select: none;
    }

    th:hover {
      background-color: #e2e2e2;
    }

    td img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    td img:hover {
      transform: scale(1.05);
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0,0,0,0.95);
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .modal-content img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
    }

    .close-btn {
      position: absolute;
      top: 20px;
      right: 30px;
      font-size: 30px;
      background: #ff4d4d;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <h2>Aniversariantes IEQ Bela Vista</h2>

  <!-- <table>
    <thead>
      <tr>
        <th onclick="ordenarTabela('id')">Id</th>
        <th onclick="ordenarTabela('nome')">Nome</th>
        <th onclick="ordenarTabela('nascimento')">Data de Nascimento</th>
        <th onclick="ordenarTabela('dias')">Dias para Aniversário</th>
        <th>Foto</th>
      </tr>
    </thead>
    <tbody id="tabela-corpo">
      <!-- Conteúdo será preenchido por JavaScript
    </tbody>
  </table> -->

  <div id="corpo-tabela">

  </div>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <button class="close-btn" onclick="fecharModal()">×</button>
      <img id="modal-img" src="" alt="Foto do aniversariante" height="1vh">
    </div>
  </div>

<div>
<input type="file" onchange="converterParaBase64(event)">
<br><br>
<img id="preview" src="" alt="Preview" width="200">
</div>

  <script>
    const pessoas = [
      {
        id: 1,
        nome: "Vitor Lima (Mídia)",
        nascimento: "1986-03-15",
        foto: "Vitor Lima (Mídia).png"
      },
      {
        id: 2,
        nome: "Alexandre Deda",
        nascimento: "1900-04-15",
        foto: ""
      },
      {
        id: 3,
        nome: "João Vitor",
        nascimento: "1900-04-08",
        foto: ""
      },
      {
        id: 4,
        nome: "Géssica (Rafael)",
        nascimento: "1900-04-05",
        foto: ""
      }
,
      {
        id: 5,
        nome: "Vanessa Barbosa",
        nascimento: "1989-05-26",
        foto: ""
      }
,
      {
        id: 6,
        nome: "Silvia (Pastora)",
        nascimento: "1960-05-08",
        foto: ""
      }
,
      {
        id: 7,
        nome: "Elaine (Mídia)",
        nascimento: "1900-02-05",
        foto: ""
      }
,
      {
        id: 8,
        nome: "Vivian (Pastora)",
        nascimento: "1900-02-27",
        foto: ""
},
      {
        id: 9,
        nome: "Pietra (Mídia)",
        nascimento: "1900-02-11",
        foto: ""
},
      {
        id: 10,
        nome: "Caren (Mídia)",
        nascimento: "1900-12-20",
        foto: ""
},
      {
        id: 11,
        nome: "Noraneide",
        nascimento: "1900-04-17",
        foto: ""
},
      {
        id: 12,
        nome: "Lenilson",
        nascimento: "1900-04-07",
        foto: ""
},
{
        id: 13,
        nome: "Liz (Giovana)",
        nascimento: "1900-04-04",
        foto: ""
},{
        id: 14,
        nome: "José Enrico",
        nascimento: "1900-04-04",
        foto: ""
},{
        id: 13,
        nome: "Beatriz",
        nascimento: "1900-03-25",
        foto: ""
},{
        id: 14,
        nome: "Luana (Mídia)",
        nascimento: "1900-03-23",
        foto: ""
},{
        id: 15,
        nome: "Gabriela",
        nascimento: "1900-03-22",
        foto: ""
},{
        id: 16,
        nome: "Janaína (Pastora)",
        nascimento: "1900-03-06",
        foto: ""
},{
        id: 17,
        nome: "Danilo",
        nascimento: "1900-03-06",
        foto: ""
},{
        id: 18,
        nome: "Regiane",
        nascimento: "1900-02-26",
        foto: ""
},{
        id: 19,
        nome: "Maria Eduarda",
        nascimento: "1900-02-25",
        foto: ""
},{
        id: 20,
        nome: "Leandra",
        nascimento: "1900-02-22",
        foto: ""
},{
        id: 21,
        nome: "Sonia (Pastora)",
        nascimento: "1900-02-19",
        foto: ""
},{
        id: 22,
        nome: "Kamilly",
        nascimento: "1900-02-12",
        foto: ""
},{
        id: 23,
        nome: "Leandra (Diaconiza)",
        nascimento: "1900-02-12",
        foto: ""
},{
        id: 24,
        nome: "Úrsula Konder",
        nascimento: "1900-02-07",
        foto: ""
},{
        id: 25,
        nome: "André (Louvor)",
        nascimento: "1900-01-24",
        foto: ""
},{
        id: 26,
        nome: "Henrique (Diácono)",
        nascimento: "1900-01-18",
        foto: ""
},{
        id: 27,
        nome: "Lúcia Costa",
        nascimento: "1900-01-15",
        foto: ""
},{
        id: 28,
        nome: "Arimatéia",
        nascimento: "1900-01-13",
        foto: ""
},{
        id: 29,
        nome: "Eliane Laurindo",
        nascimento: "1900-01-04",
        foto: ""
},{
        id: 30,
        nome: "Alan (Louvor)",
        nascimento: "1900-12-17",
        foto: ""
},
{
        id: 31,
        nome: "Ana Paula (Diaconiza)",
        nascimento: "1900-12-12",
        foto: ""
},{
        id: 32,
        nome: "Moacir (Diacono)",
        nascimento: "1900-12-04",
        foto: ""
},
{
        id: 33,
        nome: "Wanderleia",
        nascimento: "1900-12-04",
        foto: ""
},
{
        id: 34,
        nome: "Fábio",
        nascimento: "1900-12-02",
        foto: ""
},{
        id: 35,
        nome: "Izabel",
        nascimento: "1900-11-29",
        foto: ""
},
    ];

    let ordemAtual = {
      campo: null,
      crescente: true
    };

    function diasParaAniversario(dataNascimento) {
  const hoje = new Date();
  hoje.setHours(0, 0, 0, 0); // zera a hora para evitar erro de fuso

  const [ano, mes, dia] = dataNascimento.split("-");
  const anoAtual = hoje.getFullYear();

  let proximoAniversario = new Date(anoAtual, mes - 1, dia);
  proximoAniversario.setHours(0, 0, 0, 0);

  if (proximoAniversario < hoje) {
    proximoAniversario.setFullYear(anoAtual + 1);
  }

  const diffEmMs = proximoAniversario - hoje;
  return Math.round(diffEmMs / (1000 * 60 * 60 * 24)); // arredondado para evitar erros de hora
}

    function obterPessoasComDias() {
      return pessoas.map(pessoa => ({
        ...pessoa,
        dias: diasParaAniversario(pessoa.nascimento)
      }));
    }

    function ordenarTabela(campo) {
//      const corpoTabela = document.getElementById("tabela-corpo");
      const corpoTabela = document.getElementById("corpo-tabela");

      let pessoasComDias = obterPessoasComDias();

      if (ordemAtual.campo === campo) {
        ordemAtual.crescente = !ordemAtual.crescente;
      } else {
        ordemAtual.campo = campo;
        ordemAtual.crescente = true;
      }

      pessoasComDias.sort((a, b) => {
        let valorA = a[campo];
        let valorB = b[campo];

        if (campo === "nascimento") {
          valorA = new Date(valorA).getTime();
          valorB = new Date(valorB).getTime();
        }

        if (typeof valorA === 'string') {
          valorA = valorA.toLowerCase();
          valorB = valorB.toLowerCase();
        }

        if (valorA < valorB) return ordemAtual.crescente ? -1 : 1;
        if (valorA > valorB) return ordemAtual.crescente ? 1 : -1;
        return 0;
      });

      corpoTabela.innerHTML = `
  <table style="width: 100%; margin-bottom: 20px;">
    <thead>
      <tr>
        <th onclick="ordenarTabela('id')">Id</th>
        <th onclick="ordenarTabela('nome')">Nome</th>
        <th onclick="ordenarTabela('nascimento')">Data de Nascimento</th>
        <th onclick="ordenarTabela('dias')">Dias para Aniversário</th>
      </tr>
    </thead>
    <tbody>
`;

pessoasComDias.forEach(pessoa => {
  const corFundo = pessoa.dias === 0
    ? '#7FFFD4'
    : (pessoa.dias <= 10 ? '#FFF8DC' : '#fff');

  corpoTabela.innerHTML += `
    <tr>
      <td colspan="4" style="padding: 0; border: none;">
        <div style="
          background-color: ${corFundo};
          border-radius: 15px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
          margin: 10px 0;
          padding: 20px;
          display: flex;
          align-items: center;
          justify-content: space-between;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        ">
          <div style="flex: 1;">
            <h5 style="margin: 0 0 10px 0; font-size: 18px; font-weight: 600;">
              ${pessoa.id} - ${pessoa.nome}
            </h5>
            <p style="margin: 0; font-size: 15px; color: #555;">
              ${formatarDataBR(pessoa.nascimento)} —
              <strong>${pessoa.dias} dia${pessoa.dias !== 1 ? 's' : ''} faltando</strong>
            </p>
          </div>
          <div>
            <img src="imagens/${pessoa.nome}.png"
                 alt="Foto de ${pessoa.nome}"
                 onclick="abrirModal('${pessoa.nome}.png')"
                 style="max-height: 100px; border-radius: 8px; margin-left: 20px; cursor: pointer; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">
          </div>
        </div>
      </td>
    </tr>
  `;
});

corpoTabela.innerHTML += "</tbody></table>";

    }

    function abrirModal(url) {
      document.getElementById("modal-img").src = `imagens/${url}`;
      document.getElementById("modal").style.display = "flex";
    }

    function fecharModal() {
      document.getElementById("modal").style.display = "none";
      document.getElementById("modal-img").src = "";
    }

    window.addEventListener("click", function(e) {
      const modal = document.getElementById("modal");
      if (e.target === modal) {
        fecharModal();
      }
    });

    // Inicializa com ordenação por dias
    ordenarTabela("dias");

function converterParaBase64(event) {
    const file = event.target.files[0];
    const reader = new FileReader();

    reader.onload = function(e) {
      document.getElementById("preview").src = e.target.result;
      console.log("Base64:", e.target.result); // Aqui você vê o hash no console
    };

    if (file) {
      reader.readAsDataURL(file);
    }
  }

function formatarDataBR(dataStr) {
  const [ano, mes, dia] = dataStr.split("-");
  return `${dia}/${mes}/${ano}`;
}
  </script>
</body>
</html>
